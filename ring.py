for I in[I:=input]*int(I()):A,L,F,D=abs,int(I()),I(),I()+I()[::-1];G=L//2;R=0,G-1,G,L-1,0;print(min([(B:=G-A(A(i-D.index('2'))-G),B-A(A(i-x)-G)+G)[::-1]for i in range(L)for x in dict(zip('URDL',zip(R,R[1:])))[F]if'1'==D[i]])[1])